import streamlit as st
import google.generativeai as genai
from PIL import Image

# =============================
# KONFIGURASI API GEMINI
# =============================
API_KEY = "API_KEY_KAMU_DISINI"
genai.configure(api_key=API_KEY)

model_text = genai.GenerativeModel("gemini-pro")
model_vision = genai.GenerativeModel("gemini-pro-vision")

# =============================
# UI STREAMLIT
# =============================
st.set_page_config(
    page_title="AI Teknik Industri",
    page_icon="ü§ñ",
    layout="centered"
)

st.title("ü§ñ AI Asisten Teknik Industri")
st.write(
    "Asisten AI untuk membantu mata kuliah Teknik Industri. "
    "Ketik pertanyaan atau upload gambar (soal, diagram, grafik, dll)."
)

# =============================
# INPUT TEKS
# =============================
prompt = st.text_area(
    "Masukkan pertanyaan / perintah",
    placeholder="Contoh: Jelaskan diagram alir pada gambar ini atau hitung waktu baku..."
)

# =============================
# INPUT GAMBAR
# =============================
uploaded_image = st.file_uploader(
    "Upload gambar (opsional)",
    type=["jpg", "jpeg", "png"]
)

# =============================
# PROSES AI
# =============================
if st.button("üîç Proses"):
    if not prompt:
        st.warning("Masukkan pertanyaan atau perintah terlebih dahulu.")
    else:
        with st.spinner("AI sedang menganalisis..."):
            try:
                if uploaded_image:
                    image = Image.open(uploaded_image)

                    response = model_vision.generate_content([
                        prompt,
                        image
                    ])

                    st.image(image, caption="Gambar yang dianalisis", use_column_width=True)
                    st.success("Hasil Analisis:")
                    st.write(response.text)

                else:
                    response = model_text.generate_content(prompt)
                    st.success("Jawaban AI:")
                    st.write(response.text)

            except Exception as e:
                st.error(f"Terjadi kesalahan: {e}")

# =============================
# FOOTER
# =============================
st.markdown("---")
st.caption("¬© AI Teknik Industri | Powered by Gemini & Python")
